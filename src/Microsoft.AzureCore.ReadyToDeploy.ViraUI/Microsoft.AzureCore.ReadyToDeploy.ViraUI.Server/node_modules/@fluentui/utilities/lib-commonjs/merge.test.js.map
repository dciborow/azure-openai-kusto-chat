{"version":3,"file":"merge.test.js","sourceRoot":"../src/","sources":["merge.test.ts"],"names":[],"mappings":"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","sourcesContent":["import { merge } from './merge';\n\ndescribe('merge', () => {\n  it('can merge', () => {\n    expect(merge<{ a: number; b: number }>({}, { a: 1, b: 0 }, { b: 2 })).toEqual({\n      a: 1,\n      b: 2,\n    });\n  });\n\n  it('can handle falsey', () => {\n    expect(\n      merge<{ a: string; b: string | undefined }>({}, null, undefined, false, { a: '1' }, { b: '2' }, { b: undefined }),\n    ).toEqual({\n      a: '1',\n      b: undefined,\n    });\n  });\n\n  it('can handle null values', () => {\n    expect(merge({}, { a: null })).toEqual({\n      a: null,\n    });\n  });\n\n  it('can handle array values', () => {\n    expect(merge({}, { a: [1, 2] })).toEqual({ a: [1, 2] });\n  });\n\n  it('can merge deeply', () => {\n    expect(merge<{ a: { c: number }; b: number }>({}, { b: 0 }, { a: { c: 1 } }, { a: { c: 2 } })).toEqual({\n      a: { c: 2 },\n      b: 0,\n    });\n  });\n\n  it('can handle cycles', () => {\n    const obj: { foo: Object | undefined } = {\n      foo: undefined,\n    };\n\n    obj.foo = obj;\n\n    expect(merge({}, obj)).toEqual({ foo: obj });\n  });\n\n  it('can handle deep cycles', () => {\n    const obj: { foo: { bar: { baz: Object | undefined } } } = {\n      foo: {\n        bar: {\n          baz: undefined,\n        },\n      },\n    };\n\n    obj.foo.bar.baz = obj;\n\n    const result = merge({}, obj);\n\n    expect(result).toEqual({ foo: { bar: { baz: obj } } });\n    expect(result.foo).not.toBe(obj.foo);\n    expect(result.foo.bar.baz).toBe(obj);\n  });\n\n  it('can handle prototype pollution', () => {\n    const obj1 = {\n      __proto__: { payload: 'malicious value' },\n      constructor: { foo: 'malicious value' },\n    };\n    // used to check it keeps other properties\n    const obj2 = {\n      __proto__: { payload: 'malicious value' },\n      prototype: { payload: 'malicious value' },\n      constructor: { foo: 'malicious value' },\n      foo: { bar: 'baz' },\n    };\n    // used to check deep cycles\n    const obj3 = {\n      __proto__: { payload: 'malicious value' },\n      constructor: { foo: 'malicious value' },\n      a: { b: 'baz', __proto__: { payload: 'malicious value' } },\n    };\n\n    expect(merge({}, obj1)).toEqual({});\n    expect(merge({}, obj2)).toEqual({ foo: { bar: 'baz' } });\n    expect(merge({}, obj1, obj2)).toEqual({ foo: { bar: 'baz' } });\n    // Checking that merge keeps target properties but doesn't merge malicious properties\n    expect(merge(obj1, obj2, obj3)).toEqual({\n      a: { b: 'baz' },\n      constructor: { foo: 'malicious value' },\n      foo: { bar: 'baz' },\n    });\n  });\n});\n"]}