{"version":3,"file":"useCustomizationSettings.test.js","sourceRoot":"../src/","sources":["customizations/useCustomizationSettings.test.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport * as ReactTestUtils from 'react-dom/test-utils';\nimport { mount, ReactWrapper } from 'enzyme';\nimport { Customizations } from './Customizations';\nimport { CustomizerContext } from './CustomizerContext';\nimport { useCustomizationSettings } from './useCustomizationSettings';\nimport type { ISettings } from './Customizations';\n\ndescribe('useCustomizatioSettings', () => {\n  let wrapper: ReactWrapper | undefined;\n\n  afterEach(() => {\n    ReactTestUtils.act(() => {\n      wrapper?.unmount();\n      wrapper = undefined;\n    });\n    Customizations.reset();\n  });\n\n  it('get settings from Customizations', () => {\n    Customizations.applySettings({ a: 'a' });\n    const settingsStates: ISettings[] = [];\n\n    const TestComponent: React.FunctionComponent = () => {\n      const settings = useCustomizationSettings(['a']);\n\n      settingsStates.push(settings);\n      return null;\n    };\n\n    wrapper = mount(<TestComponent />);\n    expect(settingsStates.length).toBe(1);\n    expect(settingsStates[0]).toEqual({ a: 'a' });\n  });\n\n  it('get settings from Customizations when settings have changed', () => {\n    Customizations.applySettings({ a: 'a' });\n    const settingsStates: ISettings[] = [];\n\n    const TestComponent: React.FunctionComponent = () => {\n      const settings = useCustomizationSettings(['a']);\n\n      settingsStates.push(settings);\n      return null;\n    };\n\n    wrapper = mount(<TestComponent />);\n    ReactTestUtils.act(() => {\n      Customizations.applySettings({ a: 'aa' });\n    });\n    expect(settingsStates.length).toBe(2);\n    expect(settingsStates[0]).toEqual({ a: 'a' });\n    expect(settingsStates[1]).toEqual({ a: 'aa' });\n  });\n\n  it('get settings from Customizations that are not applied', () => {\n    const settingsStates: ISettings[] = [];\n\n    const TestComponent: React.FunctionComponent = () => {\n      const settings = useCustomizationSettings(['a']);\n\n      settingsStates.push(settings);\n      return null;\n    };\n\n    wrapper = mount(<TestComponent />);\n    expect(settingsStates.length).toBe(1);\n    expect(settingsStates[0]).toEqual({ a: undefined });\n  });\n\n  it('get settings from CustomizerContext', () => {\n    const settingsStates: ISettings[] = [];\n\n    const TestComponent: React.FunctionComponent = () => {\n      const settings = useCustomizationSettings(['theme']);\n\n      settingsStates.push(settings);\n      return null;\n    };\n\n    const newContext = { customizations: { settings: { theme: { color: 'red' } }, scopedSettings: {} } };\n    wrapper = mount(\n      <CustomizerContext.Provider value={newContext}>\n        <TestComponent />\n      </CustomizerContext.Provider>,\n    );\n    expect(settingsStates.length).toBe(1);\n    expect(settingsStates[0]).toEqual({ theme: { color: 'red' } });\n\n    const updatedContext = { customizations: { settings: { theme: { color: 'green' } }, scopedSettings: {} } };\n    wrapper.setProps({ value: updatedContext });\n\n    expect(settingsStates.length).toBe(2);\n    expect(settingsStates[1]).toEqual({ theme: { color: 'green' } });\n  });\n\n  it('does not re-render if global settings update but within context', () => {\n    Customizations.applySettings({ a: 'a' });\n    const settingsStates: ISettings[] = [];\n\n    const TestComponent: React.FunctionComponent = () => {\n      const settings = useCustomizationSettings(['a']);\n\n      settingsStates.push(settings);\n      return null;\n    };\n\n    const newContext = { customizations: { settings: { a: 'aa' }, scopedSettings: {}, inCustomizerContext: true } };\n    wrapper = mount(\n      <CustomizerContext.Provider value={newContext}>\n        <TestComponent />\n      </CustomizerContext.Provider>,\n    );\n\n    ReactTestUtils.act(() => {\n      Customizations.applySettings({ a: 'aaa' });\n    });\n\n    expect(settingsStates.length).toBe(1);\n    expect(settingsStates[0]).toEqual({ a: 'aa' });\n  });\n});\n"]}