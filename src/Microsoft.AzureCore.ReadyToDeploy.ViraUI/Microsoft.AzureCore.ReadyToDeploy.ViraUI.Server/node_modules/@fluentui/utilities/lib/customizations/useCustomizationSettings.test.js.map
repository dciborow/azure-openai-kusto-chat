{"version":3,"file":"useCustomizationSettings.test.js","sourceRoot":"../src/","sources":["customizations/useCustomizationSettings.test.tsx"],"names":[],"mappings":"AAAA,OAAO,KAAK,KAAK,MAAM,OAAO,CAAC;AAC/B,OAAO,KAAK,cAAc,MAAM,sBAAsB,CAAC;AACvD,OAAO,EAAE,KAAK,EAAgB,MAAM,QAAQ,CAAC;AAC7C,OAAO,EAAE,cAAc,EAAE,MAAM,kBAAkB,CAAC;AAClD,OAAO,EAAE,iBAAiB,EAAE,MAAM,qBAAqB,CAAC;AACxD,OAAO,EAAE,wBAAwB,EAAE,MAAM,4BAA4B,CAAC;AAGtE,QAAQ,CAAC,yBAAyB,EAAE;IAClC,IAAI,OAAiC,CAAC;IAEtC,SAAS,CAAC;QACR,cAAc,CAAC,GAAG,CAAC;YACjB,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,OAAO,EAAE,CAAC;YACnB,OAAO,GAAG,SAAS,CAAC;QACtB,CAAC,CAAC,CAAC;QACH,cAAc,CAAC,KAAK,EAAE,CAAC;IACzB,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,kCAAkC,EAAE;QACrC,cAAc,CAAC,aAAa,CAAC,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,CAAC;QACzC,IAAM,cAAc,GAAgB,EAAE,CAAC;QAEvC,IAAM,aAAa,GAA4B;YAC7C,IAAM,QAAQ,GAAG,wBAAwB,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;YAEjD,cAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YAC9B,OAAO,IAAI,CAAC;QACd,CAAC,CAAC;QAEF,OAAO,GAAG,KAAK,CAAC,oBAAC,aAAa,OAAG,CAAC,CAAC;QACnC,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACtC,MAAM,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,CAAC;IAChD,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,6DAA6D,EAAE;QAChE,cAAc,CAAC,aAAa,CAAC,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,CAAC;QACzC,IAAM,cAAc,GAAgB,EAAE,CAAC;QAEvC,IAAM,aAAa,GAA4B;YAC7C,IAAM,QAAQ,GAAG,wBAAwB,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;YAEjD,cAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YAC9B,OAAO,IAAI,CAAC;QACd,CAAC,CAAC;QAEF,OAAO,GAAG,KAAK,CAAC,oBAAC,aAAa,OAAG,CAAC,CAAC;QACnC,cAAc,CAAC,GAAG,CAAC;YACjB,cAAc,CAAC,aAAa,CAAC,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC;QAC5C,CAAC,CAAC,CAAC;QACH,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACtC,MAAM,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,CAAC;QAC9C,MAAM,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC;IACjD,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,uDAAuD,EAAE;QAC1D,IAAM,cAAc,GAAgB,EAAE,CAAC;QAEvC,IAAM,aAAa,GAA4B;YAC7C,IAAM,QAAQ,GAAG,wBAAwB,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;YAEjD,cAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YAC9B,OAAO,IAAI,CAAC;QACd,CAAC,CAAC;QAEF,OAAO,GAAG,KAAK,CAAC,oBAAC,aAAa,OAAG,CAAC,CAAC;QACnC,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACtC,MAAM,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE,SAAS,EAAE,CAAC,CAAC;IACtD,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,qCAAqC,EAAE;QACxC,IAAM,cAAc,GAAgB,EAAE,CAAC;QAEvC,IAAM,aAAa,GAA4B;YAC7C,IAAM,QAAQ,GAAG,wBAAwB,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;YAErD,cAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YAC9B,OAAO,IAAI,CAAC;QACd,CAAC,CAAC;QAEF,IAAM,UAAU,GAAG,EAAE,cAAc,EAAE,EAAE,QAAQ,EAAE,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,KAAK,EAAE,EAAE,EAAE,cAAc,EAAE,EAAE,EAAE,EAAE,CAAC;QACrG,OAAO,GAAG,KAAK,CACb,oBAAC,iBAAiB,CAAC,QAAQ,IAAC,KAAK,EAAE,UAAU;YAC3C,oBAAC,aAAa,OAAG,CACU,CAC9B,CAAC;QACF,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACtC,MAAM,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC;QAE/D,IAAM,cAAc,GAAG,EAAE,cAAc,EAAE,EAAE,QAAQ,EAAE,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,EAAE,EAAE,cAAc,EAAE,EAAE,EAAE,EAAE,CAAC;QAC3G,OAAO,CAAC,QAAQ,CAAC,EAAE,KAAK,EAAE,cAAc,EAAE,CAAC,CAAC;QAE5C,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACtC,MAAM,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,EAAE,CAAC,CAAC;IACnE,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,iEAAiE,EAAE;QACpE,cAAc,CAAC,aAAa,CAAC,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,CAAC;QACzC,IAAM,cAAc,GAAgB,EAAE,CAAC;QAEvC,IAAM,aAAa,GAA4B;YAC7C,IAAM,QAAQ,GAAG,wBAAwB,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;YAEjD,cAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YAC9B,OAAO,IAAI,CAAC;QACd,CAAC,CAAC;QAEF,IAAM,UAAU,GAAG,EAAE,cAAc,EAAE,EAAE,QAAQ,EAAE,EAAE,CAAC,EAAE,IAAI,EAAE,EAAE,cAAc,EAAE,EAAE,EAAE,mBAAmB,EAAE,IAAI,EAAE,EAAE,CAAC;QAChH,OAAO,GAAG,KAAK,CACb,oBAAC,iBAAiB,CAAC,QAAQ,IAAC,KAAK,EAAE,UAAU;YAC3C,oBAAC,aAAa,OAAG,CACU,CAC9B,CAAC;QAEF,cAAc,CAAC,GAAG,CAAC;YACjB,cAAc,CAAC,aAAa,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,CAAC;QAC7C,CAAC,CAAC,CAAC;QAEH,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACtC,MAAM,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC;IACjD,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["import * as React from 'react';\nimport * as ReactTestUtils from 'react-dom/test-utils';\nimport { mount, ReactWrapper } from 'enzyme';\nimport { Customizations } from './Customizations';\nimport { CustomizerContext } from './CustomizerContext';\nimport { useCustomizationSettings } from './useCustomizationSettings';\nimport type { ISettings } from './Customizations';\n\ndescribe('useCustomizatioSettings', () => {\n  let wrapper: ReactWrapper | undefined;\n\n  afterEach(() => {\n    ReactTestUtils.act(() => {\n      wrapper?.unmount();\n      wrapper = undefined;\n    });\n    Customizations.reset();\n  });\n\n  it('get settings from Customizations', () => {\n    Customizations.applySettings({ a: 'a' });\n    const settingsStates: ISettings[] = [];\n\n    const TestComponent: React.FunctionComponent = () => {\n      const settings = useCustomizationSettings(['a']);\n\n      settingsStates.push(settings);\n      return null;\n    };\n\n    wrapper = mount(<TestComponent />);\n    expect(settingsStates.length).toBe(1);\n    expect(settingsStates[0]).toEqual({ a: 'a' });\n  });\n\n  it('get settings from Customizations when settings have changed', () => {\n    Customizations.applySettings({ a: 'a' });\n    const settingsStates: ISettings[] = [];\n\n    const TestComponent: React.FunctionComponent = () => {\n      const settings = useCustomizationSettings(['a']);\n\n      settingsStates.push(settings);\n      return null;\n    };\n\n    wrapper = mount(<TestComponent />);\n    ReactTestUtils.act(() => {\n      Customizations.applySettings({ a: 'aa' });\n    });\n    expect(settingsStates.length).toBe(2);\n    expect(settingsStates[0]).toEqual({ a: 'a' });\n    expect(settingsStates[1]).toEqual({ a: 'aa' });\n  });\n\n  it('get settings from Customizations that are not applied', () => {\n    const settingsStates: ISettings[] = [];\n\n    const TestComponent: React.FunctionComponent = () => {\n      const settings = useCustomizationSettings(['a']);\n\n      settingsStates.push(settings);\n      return null;\n    };\n\n    wrapper = mount(<TestComponent />);\n    expect(settingsStates.length).toBe(1);\n    expect(settingsStates[0]).toEqual({ a: undefined });\n  });\n\n  it('get settings from CustomizerContext', () => {\n    const settingsStates: ISettings[] = [];\n\n    const TestComponent: React.FunctionComponent = () => {\n      const settings = useCustomizationSettings(['theme']);\n\n      settingsStates.push(settings);\n      return null;\n    };\n\n    const newContext = { customizations: { settings: { theme: { color: 'red' } }, scopedSettings: {} } };\n    wrapper = mount(\n      <CustomizerContext.Provider value={newContext}>\n        <TestComponent />\n      </CustomizerContext.Provider>,\n    );\n    expect(settingsStates.length).toBe(1);\n    expect(settingsStates[0]).toEqual({ theme: { color: 'red' } });\n\n    const updatedContext = { customizations: { settings: { theme: { color: 'green' } }, scopedSettings: {} } };\n    wrapper.setProps({ value: updatedContext });\n\n    expect(settingsStates.length).toBe(2);\n    expect(settingsStates[1]).toEqual({ theme: { color: 'green' } });\n  });\n\n  it('does not re-render if global settings update but within context', () => {\n    Customizations.applySettings({ a: 'a' });\n    const settingsStates: ISettings[] = [];\n\n    const TestComponent: React.FunctionComponent = () => {\n      const settings = useCustomizationSettings(['a']);\n\n      settingsStates.push(settings);\n      return null;\n    };\n\n    const newContext = { customizations: { settings: { a: 'aa' }, scopedSettings: {}, inCustomizerContext: true } };\n    wrapper = mount(\n      <CustomizerContext.Provider value={newContext}>\n        <TestComponent />\n      </CustomizerContext.Provider>,\n    );\n\n    ReactTestUtils.act(() => {\n      Customizations.applySettings({ a: 'aaa' });\n    });\n\n    expect(settingsStates.length).toBe(1);\n    expect(settingsStates[0]).toEqual({ a: 'aa' });\n  });\n});\n"]}