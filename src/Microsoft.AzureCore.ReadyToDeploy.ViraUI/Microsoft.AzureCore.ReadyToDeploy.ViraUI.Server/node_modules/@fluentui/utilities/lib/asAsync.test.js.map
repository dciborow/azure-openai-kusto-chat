{"version":3,"file":"asAsync.test.js","sourceRoot":"../src/","sources":["asAsync.test.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { asAsync } from './asAsync';\nimport { mount } from 'enzyme';\n\ndescribe('asAsync', () => {\n  it('can async load exports', (done: () => undefined) => {\n    let _resolve: (result: React.ElementType<{}>) => void = () => undefined;\n    let _loadCalled = false;\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const loadThingPromise = new Promise<any>((resolve: any) => {\n      _resolve = resolve;\n    });\n\n    const AsyncThing = asAsync({\n      load: () => {\n        _loadCalled = true;\n        return loadThingPromise;\n      },\n    });\n    const wrapper = mount(<AsyncThing />);\n\n    expect(_loadCalled).toBe(true);\n    expect(wrapper.text()).toBeFalsy();\n    expect(_resolve).toBeTruthy();\n\n    _resolve(() => <div>thing</div>);\n\n    process.nextTick(() => {\n      wrapper.update();\n      expect(wrapper.text()).toEqual('thing');\n      _loadCalled = false;\n\n      // Test cached case.\n      mount(<AsyncThing />);\n      expect(_loadCalled).toBe(false);\n      expect(wrapper.text()).toEqual('thing');\n      done();\n    });\n  });\n\n  it('can async load with placeholder', (done: () => undefined) => {\n    let _resolve: (result: React.ElementType<{}>) => void = () => undefined;\n    let _loadCalled = false;\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const loadThingPromise = new Promise<any>((resolve: any) => {\n      _resolve = resolve;\n    });\n\n    const AsyncThing = asAsync({\n      load: () => {\n        _loadCalled = true;\n        return loadThingPromise;\n      },\n    });\n    const wrapper = mount(<AsyncThing asyncPlaceholder={() => <div>placeholder</div>} />);\n\n    expect(_loadCalled).toBe(true);\n    expect(wrapper.text()).toEqual('placeholder');\n    expect(_resolve).toBeTruthy();\n\n    _resolve(() => <div>thing</div>);\n\n    process.nextTick(() => {\n      wrapper.update();\n      expect(wrapper.text()).toEqual('thing');\n      done();\n    });\n  });\n});\n"]}