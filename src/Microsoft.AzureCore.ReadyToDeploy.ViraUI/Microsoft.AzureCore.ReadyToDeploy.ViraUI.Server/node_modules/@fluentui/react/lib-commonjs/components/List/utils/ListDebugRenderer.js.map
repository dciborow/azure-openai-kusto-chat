{"version":3,"file":"ListDebugRenderer.js","sourceRoot":"../src/","sources":["components/List/utils/ListDebugRenderer.ts"],"names":[],"mappings":"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","sourcesContent":["import { IRectangle } from '@fluentui/utilities';\nimport { IPage } from '../List.types';\n\nexport type RenderParams = {\n  visibleRect: IRectangle | undefined;\n  allowedRect: IRectangle | null;\n  requiredRect: IRectangle | null;\n  materializedRect: IRectangle | null;\n  surfaceRect: IRectangle | undefined;\n  totalListHeight: number;\n  pages: IPage[] | undefined;\n  scrollTop: number;\n  estimatedLine: number;\n  scrollY: number;\n};\n\nconst RENDER_COLOR_VISIBLE_RECT = 'hotpink';\nconst RENDER_COLOR_ALLOWED_RECT = 'green';\nconst RENDER_COLOR_REQUIRED_RECT = 'blue';\nconst RENDER_COLOR_MATERIALIZED_RECT = 'red';\nconst RENDER_COLOR_SURFACE_RECT = 'black';\nconst RENDER_COLOR_PAGE = 'purple';\nconst RENDER_COLOR_SPACER_PAGE = 'orange';\n\nexport class ListDebugRenderer {\n  private _wrapper: HTMLElement;\n  private _renderer: CanvasRenderingContext2D;\n  private _doc: Document;\n\n  constructor(doc?: Document) {\n    // eslint-disable-next-line no-restricted-globals\n    this._doc = doc || document;\n    this._wrapper = this._doc.createElement('div');\n    this._wrapper.style.position = 'fixed';\n    this._wrapper.style.top = '0';\n    this._wrapper.style.right = '0';\n    this._wrapper.style.width = '300px';\n    this._wrapper.style.bottom = '0';\n\n    const canvas = this._doc.createElement('canvas');\n    this._renderer = canvas.getContext('2d') as CanvasRenderingContext2D;\n\n    this._wrapper.appendChild(canvas);\n\n    this._doc.body.appendChild(this._wrapper);\n  }\n\n  public dispose(): void {\n    this._doc.body.removeChild(this._wrapper);\n  }\n\n  public render(params: RenderParams): void {\n    const {\n      visibleRect,\n      allowedRect,\n      requiredRect,\n      materializedRect,\n      surfaceRect,\n      totalListHeight,\n      pages,\n      scrollTop,\n      estimatedLine,\n      scrollY,\n    } = params;\n\n    if (!surfaceRect) {\n      return;\n    }\n\n    const debugRendererHeight = this._wrapper.clientHeight;\n    const scaleFactor = debugRendererHeight / totalListHeight;\n\n    this._renderer.canvas.width = this._wrapper.clientWidth;\n    this._renderer.canvas.height = debugRendererHeight;\n    this._renderer.fillStyle = 'white';\n    this._renderer.fillRect(0, 0, this._wrapper.clientWidth, this._wrapper.clientHeight);\n\n    this._renderRect(\n      { left: 0, top: 0, height: totalListHeight, width: surfaceRect.width },\n      RENDER_COLOR_SURFACE_RECT,\n      scaleFactor,\n    );\n\n    if (visibleRect) {\n      this._renderRect(visibleRect, RENDER_COLOR_VISIBLE_RECT, scaleFactor, 10);\n    }\n\n    if (allowedRect) {\n      this._renderRect(allowedRect, RENDER_COLOR_ALLOWED_RECT, scaleFactor, 20);\n    }\n\n    if (requiredRect) {\n      this._renderRect(requiredRect, RENDER_COLOR_REQUIRED_RECT, scaleFactor, 30);\n    }\n\n    if (materializedRect) {\n      this._renderRect(materializedRect, RENDER_COLOR_MATERIALIZED_RECT, scaleFactor, 40);\n    }\n\n    if (pages) {\n      let top = 0;\n      pages.forEach((page, i) => {\n        const isSpacer = page.key.startsWith('spacer');\n        const t = isSpacer ? top : page.top;\n        this._renderPage(\n          page,\n          isSpacer ? RENDER_COLOR_SPACER_PAGE : RENDER_COLOR_PAGE,\n          scaleFactor,\n          surfaceRect.left,\n          surfaceRect.width,\n          t,\n          50 + i * 10,\n        );\n        top += page.height;\n      });\n    }\n\n    this._renderLine(scrollTop, 'red', surfaceRect.width);\n    this._renderLine(estimatedLine, 'black', surfaceRect.width);\n    this._renderLine(scrollY, 'yellow', surfaceRect.width);\n  }\n\n  private _renderRect(rect: IRectangle, color: string, scaleFactor: number, offset: number = 0): void {\n    this._renderer.strokeStyle = color;\n    this._renderer.strokeRect(\n      rect.left * scaleFactor + offset,\n      rect.top * scaleFactor,\n      rect.width * scaleFactor + offset,\n      rect.height * scaleFactor,\n    );\n  }\n\n  private _renderPage(\n    page: IPage,\n    color: string,\n    scaleFactor: number,\n    left: number,\n    width: number,\n    top: number,\n    offset: number = 0,\n  ): void {\n    this._renderer.strokeStyle = color;\n    this._renderer.strokeRect(\n      left * scaleFactor + offset,\n      top * scaleFactor,\n      width * scaleFactor + offset,\n      page.height * scaleFactor,\n    );\n  }\n\n  private _renderLine(y: number, color: string, width: number): void {\n    this._renderer.strokeStyle = color;\n    this._renderer.beginPath();\n    this._renderer.moveTo(0, y);\n    this._renderer.lineTo(width, y);\n    this._renderer.stroke();\n  }\n}\n"]}